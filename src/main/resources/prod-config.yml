# src/main/resources/prod-config.yml
environment: "prod"
profile: "prod"

# ============================================================================
# PROFILES CONFIGURATION - Resource allocation per environment
# ============================================================================
profiles:
  prod:
    # Full resources for production training
    spark:
      driver:
        memory: "40g"
        cores: 10
      executor:
        memory: "16g"
        cores: 6
        instances: 2
      sql:
        shufflePartitions: 400
        adaptiveEnabled: true
    data:
      sampleRatio: 1.0  # Use all data
    ml:
      cvFolds: 5
      gridSearch: true
    docker:
      workers: 2

# ============================================================================
# COMMON CONFIGURATION - Production paths
# ============================================================================
common:
  seed: 42

  data:
    basePath: "/data"
    flight:
      path: "gs://tough-artwork-475804-h0-flight-data/data/FLIGHT-3Y/Flights/*.csv"  # All years
    weather:
      path: "gs://tough-artwork-475804-h0-flight-data/data/FLIGHT-3Y/Weather/*.txt"  # All weather files
    airportMapping:
      path: "gs://tough-artwork-475804-h0-flight-data/data/FLIGHT-3Y/wban_airport_timezone.csv"

  output:
    basePath: "gs://tough-artwork-475804-h0-flight-data/output"

  mlflow:
    enabled: false
    trackingUri: "gs://tough-artwork-475804-h0-flight-data/mlflow"

# ============================================================================
# EXPERIMENTS - Production experiments
# ============================================================================
experiments:
  - name: "prod_rf_pca_cv_60min"
    description: "Production Random Forest with PCA and CV for 60+ min delays"
    enabled: true
    target: "label_is_delayed_60min"

    featureExtraction:
      type: "pca"
      dxCol: "D2_60"
      delayThresholdMin: 60
      pcaVarianceThreshold: 0.7
      storeJoinData: false
      storeExplodeJoinData: false
      weatherOriginDepthHours: 0
      weatherDestinationDepthHours: 0
      maxCategoricalCardinality: 50

    model:
      modelType: "random_forest"
      hyperparameters:
        numTrees: [100]
        maxDepth: [10]
        maxBins: [32]

    train:
      trainRatio: 0.8
      crossValidation:
        numFolds: 5
      gridSearch:
        enabled: false
        evaluationMetric: "f1"